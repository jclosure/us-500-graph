(function(){"use strict";function a(a,b){var c=a?a.length:0;if(!c)return[];var d=-1,e=[],f=b.length;a:for(;++d<c;){var g=a[d];if(g===g){for(var h=f;h--;)if(b[h]===g)continue a;e.push(g)}else b.indexOf(g)<0&&e.push(g)}return e}function b(a){h=32===a.which,f.removeEventListener("keydown",b,!1),f.addEventListener("keyup",c,!1)}function c(){h=!1,f.addEventListener("keydown",b,!1),f.removeEventListener("keyup",c,!1)}function d(c,d){function e(){d.dropEdges(),d.nodes().length===c.graph.nodes().length?d.dropNodes():d.addNodes(),c.refresh({skipIndexation:!0})}function j(){d.nodes().length&&null===g&&(g=d.nodes()[0].id)}function k(){c.renderers[0].container.lastChild.addEventListener("mousemove",j)}function l(){d.dropEdges(),d.dropNodes(),c.refresh({skipIndexation:!0})}function m(){c.graph.dropNodes(d.nodes().map(function(a){return a.id})),c.graph.dropEdges(d.edges().map(function(a){return a.id})),c.refresh()}function n(){d.addNeighbors(),c.refresh({skipIndexation:!0})}function o(){d.dropEdges(),d.setNodesBy(function(a){return 0===c.graph.degree(a.id)}),c.refresh({skipIndexation:!0})}function p(){d.dropEdges(),d.setNodesBy(function(a){return 1===c.graph.adjacentNodes(a.id).length}),c.refresh({skipIndexation:!0})}var q=0,r=null,s=null;f=f||document.getElementsByTagName("body")[0],sigma.plugins.dragNodes&&c.renderers[0].container.lastChild.addEventListener("mousedown",k),this.clickNodesHandler=function(b){if(!(q>1)){var e=b.data.node.map(function(a){return a.id}),f=d.nodes().map(function(a){return a.id}),j=a(e,f);if(d.dropEdges(),h){var k=a(e,j);d.dropNodes(k)}else f.length>1&&d.addNodes(e),d.nodes().length&&sigma.plugins.dragNodes&&(g===d.nodes()[0].id?j.length?(d.dropNodes(),g=null):setTimeout(function(){i||(d.dropNodes(),g=null,c.refresh({skipIndexation:!0}))},c.settings("doubleClickTimeout")):g=d.nodes()[0].id);d.addNodes(j),c.refresh({skipIndexation:!0})}},this.doubleClickNodesHandler=function(){i=!0,setTimeout(function(){i=!1},100+c.settings("doubleClickTimeout"))},this.clickEdgesHandler=function(b){if(!q){var e=b.data.edge.map(function(a){return a.id}),f=d.edges().map(function(a){return a.id}),g=a(e,f);if(d.dropNodes(),h){var i=a(e,g);d.dropEdges(i)}else d.dropEdges(),f.length>1&&d.addEdges(e);d.addEdges(g),c.refresh({skipIndexation:!0})}},this.dragHandler=function(){q++},this.dropHandler=function(){setTimeout(function(){q=0},1)},c.bind("clickNodes",this.clickNodesHandler),c.bind("doubleClickNodes",this.doubleClickNodesHandler),c.bind("clickEdges",this.clickEdgesHandler),this.bindDragNodes=function(a){if(!a)throw new Error('Missing argument: "dragNodes"');return r=a,r.bind("drag",this.dragHandler),r.bind("drop",this.dropHandler),this},this.unbindDragNodes=function(){return r&&(r.unbind("drag",this.dragHandler),r.unbind("drop",this.dropHandler),q=0,r=null),this},f.addEventListener("keydown",b,!1),this.bindKeyboard=function(a){if(!a)throw new Error('Missing argument: "keyboard"');return s=a,s.bind("32+65 18+32+65",e),s.bind("32+85 18+32+85",l),s.bind("32+46 18+32+46",m),s.bind("32+69 18+32+69",n),s.bind("32+73 18+32+73",o),s.bind("32+76 18+32+76",p),this},this.unbindKeyboard=function(){return s&&(s.unbind("32+65 18+32+65",e),s.unbind("32+85 18+32+85",l),s.unbind("32+46 18+32+46",m),s.unbind("32+69 18+32+69",n),s.unbind("32+73 18+32+73",o),s.unbind("32+76 18+32+76",p),s=null),this}}if("undefined"==typeof sigma)throw"sigma is not declared";sigma.utils.pkg("sigma.plugins");var e={},f=null,g=null,h=!1,i=!1;sigma.plugins.select=function(a,b){return e[a.id]||(e[a.id]=new d(a,b),a.bind("kill",function(){sigma.plugins.killSelect(a)})),e[a.id]},sigma.plugins.killSelect=function(a){e[a.id]instanceof d&&(a.unbind("clickNodes",e[a.id].clickNodesHandler),a.unbind("doubleClickNodes",e[a.id].doubleClickNodesHandler),a.unbind("clickEdges",e[a.id].clickEdgesHandler),e[a.id].unbindKeyboard(),e[a.id].unbindDragNodes(),delete e[a.id]),!e.length&&f&&(f.removeEventListener("keydown",b,!1),f.removeEventListener("keyup",c,!1),f=null)}}).call(this);
//# sourceMappingURL=sigma.plugins.select.min.js.map