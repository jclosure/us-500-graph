(function(a){"use strict";function b(a,b,c){var d=document.createElement("a");d.setAttribute("href",a),d.setAttribute("download",c||"graph."+b);var e=document.createEvent("MouseEvent");e.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),d.dispatchEvent(e),d.remove()}function c(b,c){return null===b||b===a?c+c:("function"==typeof b&&(b=b.toString()),b="string"==typeof b?b:JSON.stringify(b),b=b.replace(/\s+/g," "),c&&c.length?c+b.replace(c,'"'===c?"'":'"')+c:b)}function d(b,c){return null===c||c===a?null:c.split(".").reduce(function(a,b){return a[b]},b)}if("undefined"==typeof sigma)throw new Error("sigma is not declared");sigma.prototype.toSpreadsheet=function(a){if(a=a||{},a.separator=a.separator||",",a.textSeparator=a.textSeparator||"",a.textSeparator&&'"'!==a.textSeparator&&"'"!==a.textSeparator)throw new TypeError('Invalid argument :"textSeparator" is not single-quote or double-quote, was '+a.textSeparator);var e,f,g,h=[],i={},j=[],k=0;if(!a.what)throw new TypeError('Missing argument: "what".');if("nodes"===a.what)e=a.which?this.graph.nodes(a.which):this.graph.nodes();else{if("edges"!==a.what)throw new TypeError('Invalid argument: "what" is not "nodes" or "edges", was '+a.what);e=a.which?this.graph.edges(a.which):this.graph.edges()}i.id=k++,j.push(c("id",a.textSeparator)),"edges"===a.what&&(i.source=k++,j.push(c("source",a.textSeparator)),i.target=k++,j.push(c("target",a.textSeparator)));for(var l=0;l<e.length;l++)g=e[l],f=d(g,a.attributes)||{},Object.keys(f).forEach(function(b){b in i||(i[b]=k++,j.push(c(b,a.textSeparator)))});h.push(j);for(var l=0;l<e.length;l++){g=e[l];var m=[];m.length=k,m[0]=c(g.id,a.textSeparator),"edges"===a.what&&(m[1]=c(g.source,a.textSeparator),m[2]=c(g.target,a.textSeparator)),f=d(g,a.attributes)||{},Object.keys(f).forEach(function(b){m[i[b]]=c(f[b],a.textSeparator)}),h.push(m)}var n=h.map(function(b){return b.join(a.separator)}).join("\n");return a.download&&b("data:text/csv;charset=UTF-8,"+encodeURIComponent(n),"csv",a.filename),n}}).call(this);
//# sourceMappingURL=sigma.exporters.spreadsheet.min.js.map